# 设备使用管理系统 - 系统架构文档

## 系统概述

设备使用管理系统是一个基于 Web 的设备资源管理平台，支持设备的全生命周期管理、用户权限控制、SSH/Telnet 远程连接、使用记录追踪和数据统计分析。

## 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                         用户浏览器                               │
│                     http://localhost:5000                        │
│                                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │            登录认证系统                                  │   │
│  │  • 用户登录 (AllowedUser)                               │   │
│  │  • 管理员登录 (User: admin/admin123)                    │   │
│  │  • 密码修改                                              │   │
│  │  • localStorage 持久化登录                              │   │
│  └────────────────────────────────────────────────────────┘   │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            │ HTTP + WebSocket
                            ↓
┌─────────────────────────────────────────────────────────────────┐
│                      前端 (Vue.js 3 CDN)                         │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │  登录页面     │  │  设备管理页   │  │  使用记录页   │         │
│  │ • 用户登录    │  │ • 设备列表    │  │ • 记录查询    │         │
│  │ • 管理员登录  │  │ • 占用/释放   │  │ • 排序筛选    │         │
│  │ • 身份切换    │  │ • CRUD操作    │  │ • 导出Excel   │         │
│  └──────────────┘  │ • 标签筛选    │  └──────────────┘         │
│                    │ • 搜索功能    │                            │
│  ┌──────────────┐  │ • Excel导入   │  ┌──────────────┐         │
│  │  统计报表页   │  └──────────────┘  │  用户管理页   │         │
│  │ • 饼图统计    │                    │ • 用户CRUD    │         │
│  │ • 设备使用率  │  ┌──────────────┐  │ • 密码管理    │         │
│  │ • 用户时长    │  │  终端连接页   │  │ • Excel导入   │         │
│  └──────────────┘  │ • SSH连接     │  └──────────────┘         │
│                    │ • Telnet连接  │                            │
│  ┌────────────────────────────────────────────────────────┐   │
│  │  技术栈                                                  │   │
│  │  • Vue 3 (CDN)        • Axios           • Socket.IO    │   │
│  │  • Xterm.js           • XLSX.js         • Chart.js     │   │
│  └────────────────────────────────────────────────────────┘   │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            │ RESTful API + WebSocket
                            ↓
┌─────────────────────────────────────────────────────────────────┐
│                 后端 (Flask + Socket.IO)                         │
│                   http://localhost:5001/api                      │
│                                                                  │
│  ┌────────────────────────────────────────────────────────┐   │
│  │              API路由层 (app.py)                         │   │
│  │                                                          │   │
│  │  【设备管理】                                            │   │
│  │  • GET  /api/devices          获取设备列表             │   │
│  │  • POST /api/devices          创建设备                 │   │
│  │  • PUT  /api/devices/<id>     更新设备                 │   │
│  │  • DELETE /api/devices/<id>   删除设备                 │   │
│  │  • POST /api/devices/<id>/occupy   占用设备            │   │
│  │  • POST /api/devices/<id>/release  释放设备            │   │
│  │  • POST /api/devices/batch-import  批量导入设备        │   │
│  │                                                          │   │
│  │  【用户管理】                                            │   │
│  │  • POST /api/users/login          用户登录             │   │
│  │  • POST /api/users/change-password 修改密码            │   │
│  │  • GET  /api/users               获取用户列表          │   │
│  │  • POST /api/users               创建用户              │   │
│  │  • PUT  /api/users/<id>          更新用户              │   │
│  │  • DELETE /api/users/<id>        删除用户              │   │
│  │  • POST /api/users/batch-import  批量导入用户          │   │
│  │                                                          │   │
│  │  【记录统计】                                            │   │
│  │  • GET  /api/records             获取使用记录          │   │
│  │  • GET  /api/statistics          获取统计数据          │   │
│  │                                                          │   │
│  │  【终端连接】                                            │   │
│  │  • POST /api/terminal/connect    建立终端连接          │   │
│  │  • Socket.IO WebSocket           实时终端通信          │   │
│  └────────────────────────────────────────────────────────┘   │
│                            ↕                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │           数据模型层 (models.py)                        │   │
│  │                                                          │   │
│  │  • Device Model        设备模型                         │   │
│  │  • User Model          管理员模型                       │   │
│  │  • AllowedUser Model   普通用户模型                     │   │
│  │  • UsageRecord Model   使用记录模型                     │   │
│  │  • SSHConnection Model SSH连接配置                     │   │
│  │  • TelnetConnection    Telnet连接配置                  │   │
│  └────────────────────────────────────────────────────────┘   │
│                            ↕                                     │
│  ┌────────────────────────────────────────────────────────┐   │
│  │              SQLAlchemy ORM                             │   │
│  └────────────────────────────────────────────────────────┘   │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            │ SQL查询
                            ↓
┌─────────────────────────────────────────────────────────────────┐
│                   数据库 (SQLite)                                │
│                 device_manager.db                                │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │ devices表     │  │  users表      │  │ allowed_users │         │
│  │              │  │(管理员表)     │  │  (用户表)     │         │
│  │ • id         │  │ • id         │  │ • id         │         │
│  │ • name       │  │ • username   │  │ • account    │         │
│  │ • ip         │  │ • password   │  │ • chinese_name│        │
│  │ • username   │  │ • is_admin   │  │ • department │         │
│  │ • password   │  │ • created_at │  │ • password   │         │
│  │ • tags (JSON)│  │              │  │ • created_at │         │
│  │ • status     │  └──────────────┘  └──────────────┘         │
│  │ • created_at │                                               │
│  └──────┬───────┘                                               │
│         │                                                        │
│         │                    ┌──────────────┐                   │
│         │                    │usage_records │                   │
│         │                    │ • id         │                   │
│         └────────────────────│ • device_id  │                   │
│                              │ • user_name  │                   │
│  ┌──────────────┐            │ • user_account│                  │
│  │ssh_connections            │ • purpose    │                   │
│  │ • id         │            │ • start_time │                   │
│  │ • device_id  │            │ • end_time   │                   │
│  │ • host       │            │ • duration   │                   │
│  │ • port       │            └──────────────┘                   │
│  │ • username   │                                               │
│  │ • password   │            ┌──────────────┐                   │
│  └──────────────┘            │telnet_connect │                  │
│                              │ • id         │                   │
│                              │ • device_id  │                   │
│                              │ • host       │                   │
│                              │ • port       │                   │
│                              │ • username   │                   │
│                              │ • password   │                   │
│                              └──────────────┘                   │
└─────────────────────────────────────────────────────────────────┘
```

## 核心功能模块

### 1. 用户认证系统

```
访问系统 → 登录页面
    ↓
选择登录方式:
    • 用户登录 (AllowedUser)
    • 管理员登录 (User: admin/admin123)
    ↓
输入账号密码 → 后端验证
    ↓
验证成功:
    • 保存到 localStorage
    • 设置 axios Authorization
    • 进入主界面
    ↓
持久化登录:
    • 刷新页面自动恢复
    • 永久有效（除非手动退出）
```

### 2. 设备管理流程

#### 2.1 添加设备流程

```
管理员点击"添加设备"
       ↓
填写设备信息:
  • 名称、IP地址
  • 用户名、密码
  • SSH/Telnet连接配置
  • 标签（可多选）
       ↓
前端验证输入
       ↓
POST /api/devices
       ↓
后端接收数据
       ↓
创建Device对象及连接配置
       ↓
保存到数据库
       ↓
返回成功响应
       ↓
前端刷新设备列表
```

#### 2.2 批量导入设备

```
管理员点击"导入Excel"
       ↓
选择Excel文件
       ↓
前端解析Excel (XLSX.js)
       ↓
POST /api/devices/batch-import
       ↓
后端批量创建设备
       ↓
返回成功/失败信息
       ↓
前端显示导入结果
```

### 3. 设备占用/释放流程

#### 3.1 占用设备

```
用户选择空闲设备
       ↓
点击"占用"按钮
       ↓
填写占用信息:
  • 使用人（登录用户自动填充）
  • 使用目的
  • 预计时长
       ↓
POST /api/devices/<id>/occupy
       ↓
后端检查:
  • 设备是否空闲
  • 用户是否在允许列表
       ↓
更新设备状态为 occupied
       ↓
创建使用记录 (start_time)
       ↓
返回成功响应
       ↓
前端更新设备状态和统计
```

#### 3.2 释放设备（权限控制）

```
用户点击"释放"按钮
       ↓
权限验证:
  • 是否为设备占用者本人？
  • 或者是否为管理员？
       ↓
有权限:
  • 按钮可点击
  • 确认释放操作
       ↓
无权限:
  • 按钮禁用（灰色）
  • 提示"只有占用者本人或管理员才能释放"
       ↓
POST /api/devices/<id>/release
       ↓
后端更新:
  • 设备状态 → available
  • 记录结束时间 (end_time)
  • 计算使用时长 (duration)
       ↓
返回成功响应
       ↓
前端更新设备状态和统计
```

### 4. 设备筛选功能

```
用户在设备列表页
       ↓
可用筛选条件:
  • 搜索框: 名称/型号/位置
  • 状态筛选: 全部/空闲/占用
  • 占用筛选: 全部/本人占用/非本人占用
  • 标签筛选: 多标签组合
       ↓
前端 computed 实时筛选
       ↓
显示筛选结果
```

### 5. 终端连接流程

```
用户点击设备的"连接"按钮
       ↓
选择连接方式:
  • SSH连接
  • Telnet连接
       ↓
前端初始化 Xterm.js
       ↓
Socket.IO 建立 WebSocket 连接
       ↓
POST /api/terminal/connect
       ↓
后端通过 Paramiko 建立 SSH/Telnet
       ↓
双向数据传输:
  • 用户输入 → WebSocket → 后端 → SSH
  • SSH输出 → 后端 → WebSocket → 前端
       ↓
实时终端操作
```

### 6. 统计报表流程

```
用户切换到统计报表页
       ↓
GET /api/statistics
       ↓
后端统计:
  • 设备总数 / 空闲数 / 占用数
  • 使用记录总数
  • 设备使用排行（Top 10）
  • 用户使用时长排行（Top 10）
       ↓
返回统计数据
       ↓
前端渲染:
  • 统计卡片
  • Chart.js 饼图:
    - 设备使用占比
    - 使用人时长占比
```

### 7. 用户管理流程（管理员）

```
管理员进入用户管理页
       ↓
可执行操作:
  • 查看用户列表
  • 添加用户（设置初始密码）
  • 编辑用户信息
  • 删除用户
  • 显示/隐藏密码
  • 批量导入用户（Excel）
  • 导出用户列表（Excel）
       ↓
用户密码管理:
  • 默认密码: 123456
  • 用户可自行修改密码
  • 最小长度: 6 位
```

## 技术栈详情

### 前端技术栈

| 技术 | 版本 | 用途 | CDN链接 |
|------|------|------|---------|
| Vue.js | 3.x | 前端框架 | cdn.jsdelivr.net |
| Axios | latest | HTTP客户端 | cdn.jsdelivr.net |
| Socket.IO | 4.5.4 | WebSocket通信 | cdn.socket.io |
| Xterm.js | 5.3.0 | 终端模拟器 | cdn.jsdelivr.net |
| xterm-addon-fit | 0.8.0 | 终端自适应 | cdn.jsdelivr.net |
| XLSX.js | 0.18.5 | Excel处理 | cdn.jsdelivr.net |
| Chart.js | 4.4.0 | 图表绘制 | cdn.jsdelivr.net |
| HTML5 | - | 页面结构 | - |
| CSS3 | - | 样式和动画 | - |
| JavaScript | ES6+ | 业务逻辑 | - |

### 后端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Python | 3.7+ | 编程语言 |
| Flask | 2.3.3 | Web框架 |
| Flask-CORS | 4.0.0 | 跨域支持 |
| Flask-SQLAlchemy | 3.0.5 | ORM工具 |
| Flask-SocketIO | 5.3.4 | WebSocket支持 |
| python-socketio | 5.9.0 | Socket.IO服务端 |
| Paramiko | 3.3.1 | SSH/SFTP客户端 |
| SQLite | 3.x | 数据库 |

### 开发工具

| 工具 | 用途 |
|------|------|
| pip | Python包管理 |
| venv | Python虚拟环境 |
| start.sh | 启动脚本 |
| stop.sh | 停止脚本 |

## API接口规范

### 基础配置

- **Base URL**: `http://localhost:5001/api`
- **Content-Type**: `application/json`
- **CORS**: 已启用，允许所有源
- **认证方式**: localStorage Token（永久有效）

### 接口列表

#### 1. 用户认证接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| POST | /api/users/login | 用户登录 | 公开 |
| POST | /api/users/change-password | 修改密码 | 用户 |

**用户登录示例**:
```json
POST /api/users/login
{
  "account": "zhangsan",
  "password": "123456"
}

响应:
{
  "user": {
    "username": "zhangsan",
    "chinese_name": "张三",
    "department": "技术部",
    "is_admin": false
  }
}
```

#### 2. 设备管理接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| GET | /api/devices | 获取设备列表 | 所有用户 |
| POST | /api/devices | 创建设备 | 管理员 |
| PUT | /api/devices/:id | 更新设备 | 管理员 |
| DELETE | /api/devices/:id | 删除设备 | 管理员 |
| POST | /api/devices/:id/occupy | 占用设备 | 所有用户 |
| POST | /api/devices/:id/release | 释放设备 | 占用者/管理员 |
| POST | /api/devices/batch-import | 批量导入 | 管理员 |

#### 3. 用户管理接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| GET | /api/users | 获取用户列表 | 管理员 |
| POST | /api/users | 创建用户 | 管理员 |
| PUT | /api/users/:id | 更新用户 | 管理员 |
| DELETE | /api/users/:id | 删除用户 | 管理员 |
| POST | /api/users/batch-import | 批量导入 | 管理员 |

#### 4. 记录统计接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| GET | /api/records | 获取使用记录 | 所有用户 |
| GET | /api/statistics | 获取统计数据 | 所有用户 |

#### 5. 终端连接接口

| 方法 | 路径 | 说明 | 权限 |
|------|------|------|------|
| POST | /api/terminal/connect | 建立终端连接 | 所有用户 |
| WebSocket | Socket.IO | 实时终端通信 | 所有用户 |

### 响应格式

**成功响应**:
```json
{
  "message": "操作成功",
  "data": {...}
}
```

**错误响应**:
```json
{
  "message": "错误信息",
  "error": "详细错误"
}
```

### HTTP状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 201 | 创建成功 |
| 400 | 请求错误（参数验证失败）|
| 401 | 未授权（登录失败）|
| 403 | 禁止访问（权限不足）|
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

## 数据库设计

### ER图

```
┌──────────────┐                    ┌──────────────┐
│   User       │                    │ AllowedUser  │
│ (管理员表)    │                    │  (用户表)     │
└──────────────┘                    └──────────────┘
  • id                                • id
  • username (admin)                  • account
  • password (admin123)               • chinese_name
  • is_admin (True)                   • department
  • created_at                        • password (默认123456)
                                      • created_at
      
┌──────────────┐         ┌──────────────┐         ┌──────────────┐
│   Device     │────────<│ UsageRecord  │>────────│ AllowedUser  │
│              │  1:N    │              │   N:1   │              │
└──────┬───────┘         └──────────────┘         └──────────────┘
       │                   • id
       │                   • device_id (FK)
       │                   • user_name
       │  1:N              • user_account (FK)
       │                   • purpose
       ↓                   • start_time
┌──────────────┐           • end_time
│SSHConnection │           • duration (计算字段)
│              │
└──────────────┘         ┌──────────────┐
  • id                   │TelnetConnect │
  • device_id (FK)       │              │
  • host                 └──────────────┘
  • port (22)              • id
  • username               • device_id (FK)
  • password               • host
                          • port (23)
                          • username
                          • password

Device 表结构:
  • id (主键)
  • name (设备名称)
  • ip (IP地址)
  • username (登录用户名)
  • password (登录密码)
  • tags (JSON数组 - 标签列表)
  • status (available/occupied)
  • current_user (当前使用人)
  • current_user_account (当前使用人账号)
  • created_at (创建时间)
```

### 关系说明

1. **Device ↔ UsageRecord (1:N)**
   - 一个设备可以有多条使用记录
   - 通过 device_id 外键关联

2. **AllowedUser ↔ UsageRecord (1:N)**
   - 一个用户可以有多条使用记录
   - 通过 user_account 外键关联

3. **Device ↔ SSHConnection (1:N)**
   - 一个设备可以配置多个SSH连接
   - 支持不同端口和账号的多连接

4. **Device ↔ TelnetConnection (1:N)**
   - 一个设备可以配置多个Telnet连接
   - 支持不同端口的多连接

5. **权限模型**
   - User: 管理员账号（硬编码 admin/admin123）
   - AllowedUser: 普通用户账号（数据库管理）
   - 管理员权限: 全部功能
   - 普通用户权限: 设备占用/释放（仅自己）、查看记录、查看统计

### 数据库特性

- **持久化**: SQLite文件数据库（device_manager.db）
- **ORM**: SQLAlchemy 对象关系映射
- **事务**: 自动提交，支持回滚
- **索引**: 主键自动索引
- **约束**: 外键约束、唯一性约束

## 部署架构

### 开发环境（当前）

```
┌────────────────────────────────┐
│      localhost (开发机)         │
│                                 │
│  ┌──────────────────────────┐ │
│  │  Frontend (port 5000)    │ │
│  │  Flask static files      │ │
│  │  /frontend/index.html    │ │
│  └──────────────────────────┘ │
│             ↕                   │
│  ┌──────────────────────────┐ │
│  │  Backend (port 5001)     │ │
│  │  Flask + Socket.IO       │ │
│  │  /backend/app.py         │ │
│  └──────────┬───────────────┘ │
│             ↕                   │
│  ┌──────────────────────────┐ │
│  │  Database                │ │
│  │  SQLite file             │ │
│  │  device_manager.db       │ │
│  └──────────────────────────┘ │
└────────────────────────────────┘
```

**启动方式**:
```bash
./start.sh   # 启动前后端服务
./stop.sh    # 停止所有服务
```

### 生产环境（建议）

```
┌─────────────────────────────────────────┐
│              服务器                      │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │  Nginx (port 80/443)               │ │
│  │  • 静态文件服务                     │ │
│  │  • 反向代理 API                    │ │
│  │  • WebSocket 代理                  │ │
│  │  • SSL/TLS 终止                    │ │
│  └──────────┬─────────────────────────┘ │
│             │                             │
│             ↓                             │
│  ┌────────────────────────────────────┐ │
│  │  Gunicorn + Eventlet (port 5001)   │ │
│  │  • WSGI 服务器                      │ │
│  │  • 多进程/多线程                    │ │
│  │  • Socket.IO 支持                   │ │
│  └──────────┬─────────────────────────┘ │
│             │                             │
│             ↓                             │
│  ┌────────────────────────────────────┐ │
│  │  SQLite / PostgreSQL               │ │
│  │  • 数据持久化                       │ │
│  │  • 定期备份                         │ │
│  └────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

**Nginx 配置示例**:
```nginx
server {
    listen 80;
    server_name device-manager.example.com;

    # 前端静态文件
    location / {
        root /var/www/device-manager/frontend;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # API 反向代理
    location /api/ {
        proxy_pass http://127.0.0.1:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Socket.IO WebSocket
    location /socket.io/ {
        proxy_pass http://127.0.0.1:5001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

**Gunicorn 启动命令**:
```bash
gunicorn -w 4 -k eventlet -b 127.0.0.1:5001 app:app
```

## 系统监控建议

1. **应用监控**
   - 使用 Supervisor 守护进程
   - 配置进程自动重启
   - 日志文件轮转

2. **性能监控**
   - 监控CPU/内存使用率
   - 监控数据库查询性能
   - 监控API响应时间

3. **日志管理**
   - 访问日志（Nginx）
   - 应用日志（Flask）
   - 错误日志（Python）
   - 日志集中收集（ELK/Loki）

4. **备份策略**
   - 数据库每日备份
   - 配置文件版本控制
   - 异地备份

## 扩展方案

### 横向扩展

```
         ┌─────────────┐
         │   Nginx LB  │
         └──────┬──────┘
                │
       ┌────────┼────────┐
       ↓        ↓        ↓
   ┌──────┐ ┌──────┐ ┌──────┐
   │ App1 │ │ App2 │ │ App3 │
   └──┬───┘ └──┬───┘ └──┬───┘
      └─────────┼─────────┘
                ↓
         ┌─────────────┐
         │  Database   │
         │  (Primary)  │
         └─────────────┘
```

### 微服务拆分

```
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│ 设备服务     │  │ 用户服务     │  │ 统计服务     │
│ Device API  │  │  User API   │  │ Stats API   │
└─────────────┘  └─────────────┘  └─────────────┘
       ↓                ↓                ↓
┌─────────────────────────────────────────────────┐
│              消息队列 (RabbitMQ/Kafka)           │
└─────────────────────────────────────────────────┘
```

## 系统特性

### 已实现功能 ✅

#### 用户系统
- ✅ 双层认证体系（管理员 + 普通用户）
- ✅ 用户登录/退出
- ✅ 密码管理（修改密码、默认密码）
- ✅ localStorage 持久化登录
- ✅ 用户CRUD管理
- ✅ 用户批量导入/导出（Excel）

#### 设备管理
- ✅ 设备CRUD操作
- ✅ 设备占用/释放
- ✅ 权限控制（仅占用者或管理员可释放）
- ✅ 多维度筛选（状态/占用/标签）
- ✅ 关键字搜索
- ✅ 标签系统（多标签支持）
- ✅ 批量导入/导出（Excel）
- ✅ 设备模板下载

#### 远程连接
- ✅ SSH 远程连接（Xterm.js + Paramiko）
- ✅ Telnet 远程连接
- ✅ 多连接配置支持
- ✅ WebSocket 实时通信
- ✅ 终端窗口拖拽/最大化

#### 使用记录
- ✅ 使用记录自动追踪
- ✅ 使用时长自动计算（最小0.00小时）
- ✅ 多维度排序
- ✅ 记录筛选
- ✅ 记录导出

#### 统计分析
- ✅ 设备统计（总数/空闲/占用）
- ✅ 使用记录统计
- ✅ Chart.js 饼图展示
  - 设备使用占比（Top 10）
  - 用户使用时长占比（Top 10）

#### 用户体验
- ✅ 响应式设计
- ✅ 实时状态更新
- ✅ 友好的消息提示
- ✅ 确认对话框
- ✅ 加载状态显示
- ✅ 错误提示

### 安全性实现

#### 已实现 ✅
- ✅ 用户认证系统
- ✅ 权限控制（管理员/普通用户）
- ✅ 操作权限验证（释放设备权限）
- ✅ CORS跨域配置
- ✅ SQL注入防护（SQLAlchemy ORM）
- ✅ 输入验证（前端+后端）

#### 待增强 🔲
- 🔲 密码加密存储（当前明文）
- 🔲 HTTPS加密传输
- 🔲 JWT令牌认证（当前localStorage）
- 🔲 登录超时机制
- 🔲 请求频率限制
- 🔲 操作日志审计
- 🔲 XSS防护增强

## 系统优势

1. **零依赖部署**: 前端使用 CDN，无需 npm 构建
2. **轻量级**: SQLite 数据库，无需独立数据库服务
3. **实时性**: WebSocket 实时通信，Socket.IO 支持
4. **易用性**: 直观的UI，拖拽式操作
5. **可扩展**: 模块化设计，易于扩展功能
6. **跨平台**: Web 应用，支持所有现代浏览器

## 性能指标

- **页面加载**: < 2秒（CDN加载）
- **API响应**: < 100ms（本地）
- **并发支持**: 50+ 用户同时在线
- **数据库**: 支持 10000+ 设备记录
- **终端延迟**: < 50ms（本地网络）

## 已知限制

1. **登录有效期**: 永久有效（需要手动退出）
2. **密码存储**: 明文存储（未加密）
3. **并发控制**: 无乐观锁/悲观锁
4. **文件大小**: Excel 导入建议 < 1000 行
5. **终端连接**: 不支持文件上传/下载

## 版本更新记录

### v2.0.0 (2025-11-04) - 当前版本

**重大更新**
- ✨ 新增用户认证系统（双层：管理员+普通用户）
- ✨ 新增用户登录/退出功能
- ✨ 新增用户密码管理（修改密码、默认密码123456）
- ✨ 新增用户管理模块（CRUD、批量导入/导出）
- ✨ 新增设备释放权限控制（仅占用者或管理员）
- ✨ 新增设备筛选功能（本人占用/非本人占用）
- ✨ 新增统计报表饼图（Chart.js）
  - 设备使用占比 Top 10
  - 用户使用时长占比 Top 10
- ✨ 新增 Excel 批量操作（设备/用户导入导出）
- ✨ 新增模板下载功能

**功能优化**
- 🔧 优化登录流程（首页默认用户登录，可切换管理员）
- 🔧 优化使用时长计算（最小显示0.00，不显示负数或-）
- 🔧 优化密码显示功能（仅占用者可见）
- 🔧 优化按钮样式（统一大小和颜色）
- 🔧 优化消息提示（修复登录页无法显示问题）
- 🔧 优化设备连接（移除ADB，仅保留SSH和Telnet）

**Bug修复**
- 🐛 修复 Vue 3 兼容性问题（$set方法）
- 🐛 修复登录失败无提示问题
- 🐛 修复消息对话框层级问题

### v1.0.0 (初始版本)

**核心功能**
- ✅ 设备管理（CRUD）
- ✅ 设备占用/释放
- ✅ SSH/Telnet 远程连接
- ✅ 使用记录追踪
- ✅ 基础统计功能
- ✅ 标签系统
- ✅ 搜索筛选

## 文件结构

\`\`\`
device-manager/
├── backend/                    # 后端目录
│   ├── app.py                 # Flask 主应用
│   ├── models.py              # 数据模型
│   ├── requirements.txt       # Python依赖
│   └── device_manager.db      # SQLite数据库
│
├── frontend/                   # 前端目录
│   └── index.html             # 单页面应用（Vue 3）
│
├── start.sh                    # 启动脚本
├── stop.sh                     # 停止脚本
├── README.md                   # 项目说明
└── 架构图.md                   # 架构文档（本文件）
\`\`\`

## 快速开始

### 1. 环境要求

- Python 3.7+
- 现代浏览器（Chrome/Firefox/Safari/Edge）
- 网络连接（首次加载CDN资源）

### 2. 安装依赖

\`\`\`bash
cd backend
pip install -r requirements.txt
\`\`\`

### 3. 启动服务

\`\`\`bash
# 在项目根目录执行
./start.sh

# 或者手动启动
cd backend
python app.py
\`\`\`

### 4. 访问系统

打开浏览器访问：\`http://localhost:5000\`

### 5. 默认账号

**管理员账号**:
- 用户名: \`admin\`
- 密码: \`admin123\`

**测试用户** (需先在用户管理中添加):
- 账号: 自定义
- 默认密码: \`123456\`

### 6. 停止服务

\`\`\`bash
./stop.sh
\`\`\`

## 常见问题

### Q1: 登录后刷新页面需要重新登录？
A: 不需要。系统使用 localStorage 持久化登录状态，刷新页面会自动恢复。

### Q2: 如何重置管理员密码？
A: 管理员密码硬编码在代码中（admin/admin123），需要修改代码并重启服务。

### Q3: 普通用户密码忘记了怎么办？
A: 管理员可以在用户管理页面查看或重置用户密码。

### Q4: 可以同时多人使用吗？
A: 可以。系统支持多用户并发访问，但设备占用是独占式的。

### Q5: 数据库文件丢失怎么办？
A: 系统会自动创建新的数据库文件，但历史数据无法恢复。建议定期备份 device_manager.db。

### Q6: Excel 导入失败？
A: 请检查：
- Excel 格式是否正确（参考下载的模板）
- 必填字段是否填写完整
- 数据是否有重复（如账号、设备名称）

### Q7: 终端连接失败？
A: 请检查：
- 设备IP地址是否正确
- SSH/Telnet端口是否开放
- 用户名密码是否正确
- 网络是否连通

### Q8: 使用时长为什么是0.00？
A: 设备还在使用中（未释放），使用时长会在释放设备时自动计算。

### Q9: 为什么无法释放别人占用的设备？
A: 这是权限控制机制，只有设备占用者本人或管理员才能释放设备。

## 技术支持

如遇问题，请提供以下信息：
1. 错误截图
2. 浏览器控制台日志
3. 后端日志（终端输出）
4. 操作步骤描述

## 许可证

内部使用项目

---

**最后更新**: 2025年11月4日  
**文档版本**: 2.0
